doctype html
html
	head
		title Mental Math 2 | Play
		script(src='http://code.responsivevoice.org/responsivevoice.js')
		script(src='https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js')
		p#question #{questions[score].num1} #{questions[score].op}  #{questions[score].num2} 
			p#score #{score}
			input#answer
			button.btn.btn-primary#check-button Enter
			button.btn.btn-primary#repeat-button Repeat
			button.btn.btn-primary#break-button Break number 

	script(type="text/javascript").
		let score = !{JSON.stringify(score)};
		const questions = !{JSON.stringify(questions)};
		responsiveVoice.speak(`${questions[score].num1} ${questions[score].op} ${questions[score].num2}`);
		const $repeat = $('#repeat-button');
		//if user presses enter on the keyboard
		$(document).ready(function(){ 
			$('#answer').keypress(function(e){
				if (e.keyCode==13) $('#check-button').click();
			});
		});

		//if user clicks on enter button
		document.getElementById('check-button').addEventListener('click', function() { 
			const $scoreElem = $('#score');
			const $input = $('#answer');
			const $qElem = $('#question');
			let input = parseInt(document.getElementById('answer').value);

			if (input && typeof input === 'number') {
				if (input === questions[score].answer) {
					$input.val('');
					responsiveVoice.speak(`was ${questions[score].answer}`);
					score++
					$scoreElem.text(score);
					if (score < questions.length) {
					$qElem.text(`${questions[score].num1} ${questions[score].op}  ${questions[score].num2}`);
					setTimeout(() => { responsiveVoice.speak(`${questions[score].num1} ${questions[score].op}  ${questions[score].num2}`, "UK English Male")}, 1000);
				}

				else {
					$('#question').text('you win!');
					$('#answer').hide();
					$('#check-button').hide();
				}

				}

				else {
					$input.val('');
					responsiveVoice.speak(`${questions[score].num1} ${questions[score].op}  ${questions[score].num2}`, "UK English Male")
					console.log('wrong!');
				}
			}
			else {
				alert('Please enter a valid input!');
			}


		});
		
		$repeat.click(function() {
				responsiveVoice.speak(`${questions[score].num1} ${questions[score].op} ${questions[score].num2}`);
		});
		
	
		
		
		
